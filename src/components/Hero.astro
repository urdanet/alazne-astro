---
import Image from 'astro/components/Image.astro';
import { getLangFromUrl } from '@i18n/utils';

interface Slide {
  src: string;
  headLine?: {
    es: string;
    eus: string;
  };
  text?: {
    es: string;
    eus: string;
  };
}

interface Props {
  title: string;
  subtitle: string;
  ctaText: string;
  ctaLink: string;
}

const { title, subtitle, ctaText, ctaLink } = Astro.props;

const lang = getLangFromUrl(Astro.url);

const slides: Slide[] = [
{
    src: '/images/slide1.jpg',
    headLine: {
      es: 'Bienvenido a Nuestro Salón',
      eus: 'Ongi etorri Gure Saloira'
    },
    text: {
      es: 'La elegancia está en los pequeños detalles.',
      eus: 'Dotorezia xehetasun txikietan dago.'
    }
  },
  {
    src: '/images/slide2.jpg',
    headLine: {
      es: 'Experiencia y profesionalidad',
      eus: 'Esperientzia eta profesionaltasuna'
    },
    text: {
      es: 'Años de experiencia para dar el mejor servicio.',
      eus: 'Urteetako esperientzia zerbitzurik onena emateko.'
    }
  },
  {
    src: '/images/slide3.jpg',
    headLine: {
      es: '',
      eus: ''
    },
    text: {
      es: 'Donde la profesionalidad y la innovación está a disposición de nuestros clientes.',
      eus: 'Profesionaltasuna eta berrikuntza gure bezeroen eskura daude.'
    }
  }
];
---

<section class="relative bg-white">
  <div class="relative overflow-hidden h-96 md:h-[600px]">
    {slides.map((slide, idx) => (
      <div
        class={`absolute inset-0 transition-opacity duration-700 ${idx === 0 ? 'opacity-100 z-10' : 'opacity-0 z-0'}`}
        data-slide-index={idx}
      >
        <Image
          width={1920}
          height={1080}
          loading="eager"
          src={slide.src}
          alt={slide.headLine?.[lang] ?? `Slide ${idx + 1}`}
          class="w-full h-full object-cover"
        />
        {slide.headLine && (
          <div class="absolute inset-0 bg-black bg-opacity-50 flex flex-col items-center justify-center text-center px-4">
            <h2 class="text-3xl md:text-5xl font-bold text-white mb-4">
              {slide.headLine[lang]}
            </h2>
            {slide.text && (
              <p class="text-lg md:text-2xl text-gray-200">
                {slide.text[lang]}
              </p>
            )}
          </div>
        )}
      </div>
    ))}
  </div>
</section>

<script is:inline>

    let currentIndex = 0;
    const slides = document.querySelectorAll('[data-slide-index]');
    const totalSlides = slides.length;
    const interval = 5000;

    function showSlide(newIndex) {
      slides.forEach((slideEl, idx) => {
        if (idx === newIndex) {
          slideEl.classList.remove('opacity-0', 'z-0');
          slideEl.classList.add('opacity-100', 'z-10');
        } else {
          slideEl.classList.remove('opacity-100', 'z-10');
          slideEl.classList.add('opacity-0', 'z-0');
        }
      });
    }

    function nextSlide() {
      currentIndex = (currentIndex + 1) % totalSlides;
      showSlide(currentIndex);
    }

    // Cada X milisegundos cambiamos a la siguiente slide
    setInterval(nextSlide, interval);

    // Por si queremos empezar desde la primera
    showSlide(currentIndex);

</script>